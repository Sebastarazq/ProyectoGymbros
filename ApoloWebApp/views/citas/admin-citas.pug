extends ../layout/index2

block styles
    meta(name="csrf-token" content= csrfToken)


block contenido
    .py-10
        h1.text-4xl.my-10.font-extrabold.text-center Apolo 
            span.font-normal 
        h2.text-center.text-2xl.font-extrabold= pagina

        //- Agregamos el bot√≥n de Crear Cita fuera de la tabla
        a(href="/crear-cita" class="rounded py-2 px-10 bg-orange-500 hover:bg-orange-600 text-sm font-bold text-center text-white uppercase my-5 inline-block w-full sm:w-auto") Crear Cita

        //- Si hay citas, mostrar tabla
        if citas.length
            div(class="bg-white shadow rounded-lg my-5 overflow-x-auto")
                table(class="w-full whitespace-no-wrap divide-y divide-gray-200")
                    thead(class="bg-gray-50")
                        tr
                            th(class="w-1/4 px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider") Tipo de cita
                            th(class="w-1/4 px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider") Usuario
                            th(class="w-1/4 px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider") Fecha y hora
                            th(class="w-1/4 px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider") Estado
                            th(class="w-1/4 px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider") Opciones
                    tbody(class="bg-white divide-y divide-gray-200")
                        each cita in citas
                            tr(class="h-10")
                                td(class="px-6 py-4 whitespace-nowrap text-center")
                                    span(class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800")
                                        = cita.cita.tipoCita.nombre
                                td(class="px-6 py-4 whitespace-nowrap text-center")
                                    - if (cita.cita.usuario) 
                                        = cita.cita.usuario.nombre + ' ' + cita.cita.usuario.apellido
                                    - else 
                                        | Usuario pendiente de confirmar
                                td(class="px-6 py-4 whitespace-nowrap text-center")
                                    = new Date(cita.cita.fecha).toLocaleDateString('es-ES') + ' ' + new Date('1970-01-01T' + cita.cita.hora).toLocaleTimeString('en-US', {hour: '2-digit', minute:'2-digit'})
                                td(class="px-6 py-4 whitespace-nowrap text-center")
                                    span(class=`px-2 inline-flex text-xs leading-5 font-semibold rounded-full 
                                                ${cita.estadoCita.nombre === 'Confirmada' ? 'bg-green-100 text-green-800' : 
                                                cita.estadoCita.nombre === 'Pendiente' ? 'bg-yellow-100 text-yellow-800' : 
                                                cita.estadoCita.nombre === 'Cancelada' ? 'bg-red-100 text-red-800' : ''}`)
                                        = cita.estadoCita.nombre
                                td(class="px-6 py-4 pl-2 whitespace-nowrap text-center")
                                    div(class="flex justify-center items-center my-2 space-x-2")
                                        a(href=`/cita/editar/${cita.cita.id}` class="text-center px-2 py-2 md:py-1 text-xs leading-5 font-semibold rounded cursor-pointer bg-indigo-100 text-indigo-800") Editar
                                        form(method="POST" action=`/cita/eliminar/${cita.cita.id}` class="mx-2")
                                            input(type="hidden" name="_csrf" value=csrfToken)
                                            input(type="submit" class="px-2 py-2 md:py-1 text-xs leading-5 font-semibold rounded cursor-pointer bg-red-100 text-red-800", value="Eliminar")
                                        a(href="/cita-estado/" class="cambiar-estado text-center px-2 py-2 md:py-1 text-xs leading-5 font-semibold rounded cursor-pointer bg-green-100 text-green-800") Estado


        //- Si no hay citas, mostrar mensaje
        else
            p.text-center No hay citas
